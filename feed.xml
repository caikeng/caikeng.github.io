<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2019-01-21T19:00:31+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">caikeng</title><subtitle>踩坑之路</subtitle><entry><title type="html">上传镜像到私有仓库</title><link href="http://localhost:4000/holmes/2019/01/21/push-image-registry.html" rel="alternate" type="text/html" title="上传镜像到私有仓库" /><published>2019-01-21T00:00:00+08:00</published><updated>2019-01-21T00:00:00+08:00</updated><id>http://localhost:4000/holmes/2019/01/21/push-image-registry</id><content type="html" xml:base="http://localhost:4000/holmes/2019/01/21/push-image-registry.html">&lt;p&gt;&lt;strong&gt;问题描述:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;​	通过命令行docker push 192.168.215.200:5000/java:latest将镜像推送到另一台主机搭建的私有仓库中。&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Get https://192.168.215.200:5000/v1/_ping: http: server gave HTTP response to HTTPS client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;原因:&lt;/strong&gt;
	为了保证安全，跨机的镜像推送操作默认采用的都是https协议。客户端采用https，而docker registry未采用https服务所致。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解决步骤:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;insecure registry配置
  在文件/etc/docker/daemon.json中添加一下内容&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s2&quot;&gt;&quot;insecure-registries&quot;&lt;/span&gt;:[
            &lt;span class=&quot;s2&quot;&gt;&quot;192.168.215.200:5000&quot;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;secure registry
&lt;a href=&quot;https://www.cnblogs.com/xcloudbiz/articles/5526262.html&quot;&gt;喜欢我就戳我&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name></name></author><category term="docker" /><category term="registry" /><summary type="html">问题描述:</summary></entry><entry><title type="html">启动docker容器</title><link href="http://localhost:4000/holmes/2019/01/20/docker-container-start.html" rel="alternate" type="text/html" title="启动docker容器" /><published>2019-01-20T00:00:00+08:00</published><updated>2019-01-20T00:00:00+08:00</updated><id>http://localhost:4000/holmes/2019/01/20/docker-container-start</id><content type="html" xml:base="http://localhost:4000/holmes/2019/01/20/docker-container-start.html">&lt;p&gt;&lt;strong&gt;问题描述:&lt;/strong&gt;
	重启Linux系统，发现某个容器停止，然后通过命令docker start 2c36e8c5614(containerId)重新启动容器，报错信息如下。&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Error response from daemon：Cannot start container 2c36e8c5614：[8]System error：Unit 2c36eb8c56148b2ee2ec2e42c0f2c690d561ab1ac9773920bada4ffde064faf3.scope already exists
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;原因:&lt;/strong&gt;
	容器异常退出。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解决步骤:&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1、systemctl stop docker-2c36eb8c56148b2ee2ec2e42c0f2c690d561ab1ac9773920bada4ffde064faf3.scope
2、docker start 2c36eb8c5614
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><category term="docker" /><summary type="html">问题描述: 重启Linux系统，发现某个容器停止，然后通过命令docker start 2c36e8c5614(containerId)重新启动容器，报错信息如下。</summary></entry><entry><title type="html">java mysql 插入数据 阻塞</title><link href="http://localhost:4000/brandon/2019/01/12/java-mysql.html" rel="alternate" type="text/html" title="java mysql 插入数据 阻塞" /><published>2019-01-12T00:00:00+08:00</published><updated>2019-01-12T00:00:00+08:00</updated><id>http://localhost:4000/brandon/2019/01/12/java-mysql</id><content type="html" xml:base="http://localhost:4000/brandon/2019/01/12/java-mysql.html">&lt;p&gt;Java 项目，使用 MyBatis 向 MySQL 中插入数据时，线程阻塞住了，很长时间都不返回。&lt;/p&gt;

&lt;h4 id=&quot;解决步骤&quot;&gt;解决步骤&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;使用客户端工具登入mysql&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;查看正在执行的语句&lt;/p&gt;

    &lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;show&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;processlist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;显示如下信息:&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;Id&lt;/th&gt;
          &lt;th&gt;User&lt;/th&gt;
          &lt;th&gt;Host&lt;/th&gt;
          &lt;th&gt;db&lt;/th&gt;
          &lt;th&gt;Command&lt;/th&gt;
          &lt;th&gt;Time&lt;/th&gt;
          &lt;th&gt;State&lt;/th&gt;
          &lt;th&gt;Info&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;*&lt;/td&gt;
          &lt;td&gt;*&lt;/td&gt;
          &lt;td&gt;*&lt;/td&gt;
          &lt;td&gt;*&lt;/td&gt;
          &lt;td&gt;Query&lt;/td&gt;
          &lt;td&gt;131&lt;/td&gt;
          &lt;td&gt;Starting&lt;/td&gt;
          &lt;td&gt;Commit&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;搜索上述信息的含义：&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Command=Query 表示有语句正在执行；&lt;/li&gt;
      &lt;li&gt;State=Starting 官方文档没有介绍&lt;/li&gt;
      &lt;li&gt;Info=Commit 官方文档没有介绍&lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;看完并没有什么头绪。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;鼓捣了半天，发现是磁盘满了, 想删除一些没用数据，结果还是不行。因为连undo日志都没地方放了。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;磁盘扩容后一切正常。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;补充&quot;&gt;补充&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;好奇怪，没有超时时间吗，程序一直阻塞着。&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="Java" /><category term="Mysql" /><summary type="html">Java 项目，使用 MyBatis 向 MySQL 中插入数据时，线程阻塞住了，很长时间都不返回。</summary></entry><entry><title type="html">python redis setex指令 执行不成功</title><link href="http://localhost:4000/brandon/2019/01/11/python-redis.html" rel="alternate" type="text/html" title="python redis setex指令 执行不成功" /><published>2019-01-11T00:00:00+08:00</published><updated>2019-01-11T00:00:00+08:00</updated><id>http://localhost:4000/brandon/2019/01/11/python-redis</id><content type="html" xml:base="http://localhost:4000/brandon/2019/01/11/python-redis.html">&lt;p&gt;&lt;strong&gt;问题描述:&lt;/strong&gt; Python 项目，调用 &lt;code class=&quot;highlighter-rouge&quot;&gt;redis.setex&lt;/code&gt; 函数设置缓存后，通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;redis-cli&lt;/code&gt; 查看，发现并没有设置成功。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解决步骤:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;查看 db 配置&lt;/p&gt;

    &lt;p&gt;发现 db 使用的默认配置，也就是 0&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;再次通过 redis-cli 查看&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; 127.0.0.1:6379[1]&amp;gt; &lt;span class=&quot;k&quot;&gt;select &lt;/span&gt;0
 127.0.0.1:6379&amp;gt; keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;还是没有。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;查看&lt;code class=&quot;highlighter-rouge&quot;&gt;setex&lt;/code&gt;函数，函数定义如下：&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;查看调用代码:&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expire&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;发现，参数顺序写反了，改正：&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;setex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expire&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;改正之后，设置成功。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;总结&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;参数写反了，执行却返回 &lt;code class=&quot;highlighter-rouge&quot;&gt;True&lt;/code&gt; , 没有抛出异常。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;Spring&lt;/code&gt; 写多了项目，习惯了下面的参数顺序:&lt;/p&gt;

    &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TimeUnit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Python redis 函数中的参数顺序与 &lt;code class=&quot;highlighter-rouge&quot;&gt;redis-cli&lt;/code&gt; 中的参数顺序一致。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="Python" /><category term="Redis" /><summary type="html">问题描述: Python 项目，调用 redis.setex 函数设置缓存后，通过 redis-cli 查看，发现并没有设置成功。</summary></entry><entry><title type="html">Flask 无法获取请求头数据</title><link href="http://localhost:4000/brandon/2019/01/08/flask-httpheader.html" rel="alternate" type="text/html" title="Flask 无法获取请求头数据" /><published>2019-01-08T00:00:00+08:00</published><updated>2019-01-08T00:00:00+08:00</updated><id>http://localhost:4000/brandon/2019/01/08/flask-httpheader</id><content type="html" xml:base="http://localhost:4000/brandon/2019/01/08/flask-httpheader.html">&lt;p&gt;&lt;strong&gt;问题描述:&lt;/strong&gt; 使用如下代码获取请求头中的数据，拿不到值（客户端也使用 http_token）&lt;/p&gt;
&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;http_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http_token&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;解决步骤:&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;打印请求头中的数据&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;发现客户端无论使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;http-token&lt;/code&gt; 还是 &lt;code class=&quot;highlighter-rouge&quot;&gt;http_token&lt;/code&gt; 请求头在服务端都变成了”Http-Token”。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;在服务端修改，使用如下代码获取请求头中的数据，问题解决&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;http_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http-token&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;总结:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;看来是 Flask 自动把请求头的格式修改了。&lt;/p&gt;</content><author><name></name></author><category term="Python" /><category term="Flash" /><category term="Http" /><summary type="html">问题描述: 使用如下代码获取请求头中的数据，拿不到值（客户端也使用 http_token） http_token=request.header.get_all(&quot;http_token&quot;)</summary></entry><entry><title type="html">Logback 日志按天轮换问题</title><link href="http://localhost:4000/brandon/2019/01/03/logback-rotation.html" rel="alternate" type="text/html" title="Logback 日志按天轮换问题" /><published>2019-01-03T00:00:00+08:00</published><updated>2019-01-03T00:00:00+08:00</updated><id>http://localhost:4000/brandon/2019/01/03/logback-rotation</id><content type="html" xml:base="http://localhost:4000/brandon/2019/01/03/logback-rotation.html">&lt;p&gt;Java 项目，使用 Logback 按天轮换日志，配置如下所示，问题是有时无法看到前一天生成的日志。&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;appender&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;INFO_LOG_FILE&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;file&amp;gt;&lt;/span&gt;${LOG_PATH}/info.log&lt;span class=&quot;nt&quot;&gt;&amp;lt;/file&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;rollingPolicy&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;fileNamePattern&amp;gt;&lt;/span&gt;${LOG_PATH}/info/{yyyy-MM-dd}_info.log&lt;span class=&quot;nt&quot;&gt;&amp;lt;/fileNamePattern&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;maxHistory&amp;gt;&lt;/span&gt;30&lt;span class=&quot;nt&quot;&gt;&amp;lt;/maxHistory&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/rollingPolicy&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;append&amp;gt;&lt;/span&gt;true&lt;span class=&quot;nt&quot;&gt;&amp;lt;/append&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;encoder&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;Pattern&amp;gt;&lt;/span&gt;${format}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Pattern&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;charset&amp;gt;&lt;/span&gt;utf8&lt;span class=&quot;nt&quot;&gt;&amp;lt;/charset&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/encoder&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;filter&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;level&amp;gt;&lt;/span&gt;info&lt;span class=&quot;nt&quot;&gt;&amp;lt;/level&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;onMatch&amp;gt;&lt;/span&gt;ACCEPT&lt;span class=&quot;nt&quot;&gt;&amp;lt;/onMatch&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;onMismatch&amp;gt;&lt;/span&gt;DENY&lt;span class=&quot;nt&quot;&gt;&amp;lt;/onMismatch&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/filter&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/appender&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;解决步骤&quot;&gt;解决步骤&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;网上搜索答案
 百思不得其解&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;查看源码&lt;/p&gt;

    &lt;p&gt;2.1 查看日志策略 &lt;code class=&quot;highlighter-rouge&quot;&gt;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&lt;/code&gt;
 发现其内置了一个策略触发器:&lt;/p&gt;
    &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;n&quot;&gt;TimeBasedFileNamingAndTriggeringPolicy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timeBasedFileNamingAndTriggeringPolicy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;且将其设置为默认的触发策略:&lt;/p&gt;
    &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timeBasedFileNamingAndTriggeringPolicy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;timeBasedFileNamingAndTriggeringPolicy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DefaultTimeBasedFileNamingAndTriggeringPolicy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;2.2 查看默认的日志出发策略 &lt;code class=&quot;highlighter-rouge&quot;&gt;DefaultTimeBasedFileNamingAndTriggeringPolicy&lt;/code&gt;
 其中的 &lt;code class=&quot;highlighter-rouge&quot;&gt;isTriggeringEvent&lt;/code&gt; 方法实现了日志轮换的逻辑：&lt;/p&gt;
    &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;isTriggeringEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;File&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activeFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;getCurrentTime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
     &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nextCheck&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;Date&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dateOfElapsedPeriod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dateInCurrentPeriod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;addInfo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Elapsed period: &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dateOfElapsedPeriod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;elapsedPeriodsFileName&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tbrp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;fileNamePatternWithoutCompSuffix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dateOfElapsedPeriod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;setDateInCurrentPeriod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
         &lt;span class=&quot;n&quot;&gt;computeNextCheck&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;2.3 通过查看函数调用，发现 &lt;strong&gt;只有在有新的日志写入时，才判断是否轮换日志&lt;/strong&gt; 。
 &lt;code class=&quot;highlighter-rouge&quot;&gt;ch.qos.logback.core.rolling.RollingFileAppender&lt;/code&gt; :&lt;/p&gt;
    &lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
 &lt;span class=&quot;kd&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;subAppend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;E&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
     &lt;span class=&quot;c1&quot;&gt;// The roll-over check must precede actual writing. This is the&lt;/span&gt;
     &lt;span class=&quot;c1&quot;&gt;// only correct behavior for time driven triggers.&lt;/span&gt;
     &lt;span class=&quot;c1&quot;&gt;// We need to synchronize on triggeringPolicy so that only one rollover&lt;/span&gt;
     &lt;span class=&quot;c1&quot;&gt;// occurs at a time&lt;/span&gt;
     &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;triggeringPolicy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;triggeringPolicy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;isTriggeringEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;currentlyActiveFile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;rollover&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
     &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;subAppend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;补充&quot;&gt;补充&lt;/h4&gt;

&lt;p&gt;那么有没有定时生成日志的配置？
效果是：到了0点必须生成前一天的日志。&lt;/p&gt;</content><author><name></name></author><category term="Java" /><category term="Logback" /><summary type="html">Java 项目，使用 Logback 按天轮换日志，配置如下所示，问题是有时无法看到前一天生成的日志。 &amp;lt;appender name=&quot;INFO_LOG_FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&amp;gt; &amp;lt;file&amp;gt;${LOG_PATH}/info.log&amp;lt;/file&amp;gt; &amp;lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&amp;gt; &amp;lt;fileNamePattern&amp;gt;${LOG_PATH}/info/{yyyy-MM-dd}_info.log&amp;lt;/fileNamePattern&amp;gt; &amp;lt;maxHistory&amp;gt;30&amp;lt;/maxHistory&amp;gt; &amp;lt;/rollingPolicy&amp;gt; &amp;lt;append&amp;gt;true&amp;lt;/append&amp;gt; &amp;lt;encoder class=&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;&amp;gt; &amp;lt;Pattern&amp;gt;${format}&amp;lt;/Pattern&amp;gt; &amp;lt;charset&amp;gt;utf8&amp;lt;/charset&amp;gt; &amp;lt;/encoder&amp;gt; &amp;lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&amp;gt; &amp;lt;level&amp;gt;info&amp;lt;/level&amp;gt; &amp;lt;onMatch&amp;gt;ACCEPT&amp;lt;/onMatch&amp;gt; &amp;lt;onMismatch&amp;gt;DENY&amp;lt;/onMismatch&amp;gt; &amp;lt;/filter&amp;gt; &amp;lt;/appender&amp;gt;</summary></entry><entry><title type="html">Welcome to CaiKeng!</title><link href="http://localhost:4000/brandon/2019/01/01/welcome-to-caikeng.html" rel="alternate" type="text/html" title="Welcome to CaiKeng!" /><published>2019-01-01T00:00:00+08:00</published><updated>2019-01-01T00:00:00+08:00</updated><id>http://localhost:4000/brandon/2019/01/01/welcome-to-caikeng</id><content type="html" xml:base="http://localhost:4000/brandon/2019/01/01/welcome-to-caikeng.html">&lt;p&gt;欢迎来到踩坑，这是一个分享踩坑经历的地方。&lt;/p&gt;</content><author><name></name></author><category term="introduce" /><category term="sticky" /><summary type="html">欢迎来到踩坑，这是一个分享踩坑经历的地方。</summary></entry><entry><title type="html">ffmpeg 转换 mp4 自定义start的值</title><link href="http://localhost:4000/brandon/2018/12/26/ffmpeg-start.html" rel="alternate" type="text/html" title="ffmpeg 转换 mp4 自定义start的值" /><published>2018-12-26T00:00:00+08:00</published><updated>2018-12-26T00:00:00+08:00</updated><id>http://localhost:4000/brandon/2018/12/26/ffmpeg-start</id><content type="html" xml:base="http://localhost:4000/brandon/2018/12/26/ffmpeg-start.html">&lt;p&gt;&lt;strong&gt;问题描述:&lt;/strong&gt;
一段 mp4 视频由很多片段组成，使用 ffmpeg 将各个 mp4 片段文件转换为 ts 文件，之后使用 hls 协议播放一整段视频。发现进度条一直在前几秒循环式地跳。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;解决步骤:&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;从网上找了一段正常的视频，使用 ffmpeg 对比了正常的视频各个 ts 文件的元数据和本地不正常的视频各个 ts 文件的元数据。
发现正常视频片段的 start 值是连续的，不正常的视频片段的 start 值都是固定的，由此认为 start 决定了进度条的初始位置。&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; ffmpeg version 4.1-tessus  https://evermeet.cx/ffmpeg/  Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2000-2018 the FFmpeg developers
   built with Apple LLVM version 10.0.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;clang-1000.11.45.5&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   configuration: &lt;span class=&quot;nt&quot;&gt;--cc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/bin/clang &lt;span class=&quot;nt&quot;&gt;--prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/opt/ffmpeg &lt;span class=&quot;nt&quot;&gt;--extra-version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;tessus &lt;span class=&quot;nt&quot;&gt;--enable-avisynth&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-fontconfig&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-gpl&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libaom&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libass&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libbluray&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libfreetype&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libgsm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libmodplug&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libmp3lame&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libmysofa&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libopencore-amrnb&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libopencore-amrwb&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libopus&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-librubberband&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libshine&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libsnappy&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libsoxr&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libspeex&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libtheora&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libtwolame&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libvidstab&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libvo-amrwbenc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libvorbis&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libvpx&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libwavpack&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libx264&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libx265&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libxavs&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libxvid&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libzimg&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libzmq&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-libzvbi&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--enable-version3&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--pkg-config-flags&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--static&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--disable-ffplay&lt;/span&gt;
   libavutil      56. 22.100 / 56. 22.100
   libavcodec     58. 35.100 / 58. 35.100
   libavformat    58. 20.100 / 58. 20.100
   libavdevice    58.  5.100 / 58.  5.100
   libavfilter     7. 40.101 /  7. 40.101
   libswscale      5.  3.100 /  5.  3.100
   libswresample   3.  3.100 /  3.  3.100
   libpostproc    55.  3.100 / 55.  3.100
 Input &lt;span class=&quot;c&quot;&gt;#0, mpegts, from 'b.ts':&lt;/span&gt;
   Duration: 00:00:10.00, start: 11.400000
   , bitrate: 1879 kb/s
   Program 1 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;想修改视频的 start 值， 经高人指点发现使用如下方式可以修改。
这条命令是将 mp4 文件转换为 ts 文件，同时使用 &lt;strong&gt;initial_offset&lt;/strong&gt; 参数指定第一个视频文件的 start 值。&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; ffmpeg &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 0.mp4 &lt;span class=&quot;nt&quot;&gt;-vcodec&lt;/span&gt; copy &lt;span class=&quot;nt&quot;&gt;-acodec&lt;/span&gt; aac &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; segment &lt;span class=&quot;nt&quot;&gt;-initial_offset&lt;/span&gt; 9.5 &lt;span class=&quot;nt&quot;&gt;-segment_format&lt;/span&gt; mpegts out%d.ts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;使用如上配置生成的 ts 文件播放后进度条就不跳跃了，问题得到解决。&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name></name></author><category term="ffmpeg" /><category term="hls" /><summary type="html">问题描述: 一段 mp4 视频由很多片段组成，使用 ffmpeg 将各个 mp4 片段文件转换为 ts 文件，之后使用 hls 协议播放一整段视频。发现进度条一直在前几秒循环式地跳。</summary></entry></feed>